generator client {
    provider      = "prisma-client-js"
    binaryTargets = ["native"]
}

datasource db {
    provider = "postgresql"
    url      = env("DB_URL")
}

model Team {
    // Slack channel ID
    id         String  @id
    name       String
    active     Boolean
    postDay    Int
    postHour   Int
    revealDay  Int
    revealHour Int
    // In the future the team can edit the questions
    questions  Json
    Asked      Asked[]
}

model Asked {
    id        Int      @id @default(autoincrement())
    team      Team     @relation(fields: [teamId], references: [id])
    // Slack timestamp is used as message ID in the channel
    messageTs String
    teamId    String
    timestamp DateTime
    questions Json
    revealed  Boolean
    answers   Answer[]
}

model Answer {
    answeredAt DateTime
    asked      Asked    @relation(fields: [askedId], references: [id])
    askedId    Int
    answers    Json
    // Slack user ID, only used to keep answers unique per user
    userId     String

    @@id([userId, askedId])
}
